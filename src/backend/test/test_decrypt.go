package main

import (
	"encoding/base64"
	"fmt"
	"log"
	"os"

	"github.com/aresnasa/ai-infra-matrix/src/backend/internal/config"
	"github.com/aresnasa/ai-infra-matrix/src/backend/internal/utils"
)

func main() {
	// Load configuration
	cfg := config.Load()

	// Initialize crypto service
	cryptoService := utils.NewCryptoService(cfg.EncryptionKey)

	// The encrypted kubeconfig from database
	encryptedKubeconfig := "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"

	// Decode base64
	encryptedData, err := base64.StdEncoding.DecodeString(encryptedKubeconfig)
	if err != nil {
		log.Fatalf("Failed to decode base64: %v", err)
	}

	// Decrypt
	decryptedData, err := cryptoService.Decrypt(encryptedData)
	if err != nil {
		log.Fatalf("Failed to decrypt: %v", err)
	}

	fmt.Println("=== Decrypted Kubeconfig Content ===")
	fmt.Printf("Length: %d bytes\n", len(decryptedData))
	fmt.Println("Content:")
	fmt.Println(string(decryptedData))
	fmt.Println("=== End of Content ===")

	// Check for invisible characters at the beginning and end
	fmt.Printf("\nFirst 10 bytes (hex): %x\n", decryptedData[:min(10, len(decryptedData))])
	fmt.Printf("Last 10 bytes (hex): %x\n", decryptedData[max(0, len(decryptedData)-10):])
}

func min(a, b int) int {
	if a < b {
		return a
	}
	return b
}

func max(a, b int) int {
	if a > b {
		return a
	}
	return b
}
