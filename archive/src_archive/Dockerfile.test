# 测试容器Dockerfile
FROM node:18-alpine

# 配置Alpine镜像（多镜像自动回退）
RUN set -eux; \
	for MIR in mirrors.tuna.tsinghua.edu.cn mirrors.aliyun.com mirrors.ustc.edu.cn dl-cdn.alpinelinux.org; do \
		sed -i "s#://[^/]\+/alpine#://$MIR/alpine#g" /etc/apk/repositories || true; \
		apk update && break || true; \
	done

# 安装基本工具
RUN apk add --no-cache curl wget

# 设置工作目录
WORKDIR /app

# 复制测试脚本
COPY test_container.js .

# 使脚本可执行
RUN chmod +x test_container.js

# 默认命令
CMD ["node", "test_container.js"]
