# AI Infrastructure Matrix Helm Chart Values
# Generated from environment variables

global:
  imageRegistry: ""
  imageTag: ""
  
env:
  # This section will be populated from .env file
  COMPOSE_PROJECT_NAME: "ai-infra-matrix"
  IMAGE_TAG: "v0.3.5"
  BUILD_ENV: "development"
  DEBUG_MODE: "true"
  LOG_LEVEL: "debug"
  ENV_FILE: ".env"
  TZ: "Asia/Shanghai"
  DOMAIN: "localhost"
  NGINX_PORT: "8080"
  POSTGRES_HOST: "postgres"
  POSTGRES_PORT: "5432"
  POSTGRES_DB: "ansible_playbook_generator"
  POSTGRES_USER: "postgres"
  POSTGRES_PASSWORD: "postgres"
  JUPYTERHUB_DB_NAME: "jupyterhub_db"
  JUPYTERHUB_DB_USER: "postgres"
  JUPYTERHUB_DB_PASSWORD: "postgres"
  GITEA_DB_TYPE: "postgres"
  GITEA_DB_HOST: "postgres:5432"
  GITEA_DB_NAME: "gitea"
  GITEA_DB_USER: "gitea"
  GITEA_DB_PASSWD: "gitea-password"
  REDIS_HOST: "redis"
  REDIS_PORT: "6379"
  REDIS_PASSWORD: "ansible-redis-password"
  REDIS_DB: "0"
  REDIS_CACHE_DB: "1"
  LDAP_SERVER: "openldap"
  LDAP_PORT: "389"
  LDAP_BASE_DN: "dc=ai-infra,dc=com"
  LDAP_BIND_DN: "cn=admin,dc=ai-infra,dc=com"
  LDAP_ADMIN_PASSWORD: "admin123"
  LDAP_CONFIG_PASSWORD: "config123"
  LDAP_USER_BASE: "ou=users,dc=ai-infra,dc=com"
  LDAP_GROUP_BASE: "ou=groups,dc=ai-infra,dc=com"
  LDAP_USER_FILTER: "(uid=%s)"
  LDAP_ADMIN_GROUP: "administrators"
  MINIO_HOST: "minio"
  MINIO_PORT: "9000"
  MINIO_ACCESS_KEY: "minioadmin"
  MINIO_SECRET_KEY: "minioadmin"
  MINIO_BUCKET_DEFAULT: "ai-infra"
  MINIO_BUCKET_GITEA: "gitea"
  MINIO_BUCKET_JUPYTER: "jupyter"
  STORAGE_TYPE: "local"
  GITEA_STORAGE: "local"
  JWT_SECRET: "ai-infra-secret-key-change-in-dev"
  JWT_EXPIRY: "24h"
  JWT_REFRESH_EXPIRY: "168h"
  SESSION_SECRET: "ai-infra-session-secret-key"
  SESSION_TIMEOUT: "86400"
  OAUTH_ENABLED: "false"
  OAUTH_CLIENT_ID: ""
  OAUTH_CLIENT_SECRET: ""
  OAUTH_REDIRECT_URL: ""
  JUPYTERHUB_HOST: "jupyterhub"
  JUPYTERHUB_PORT: "8000"
  CONFIGPROXY_AUTH_TOKEN: "ai-infra-proxy-token-dev"
  JUPYTERHUB_CRYPT_KEY: "790031b2deeb70d780d4ccd100514b37f3c168ce80141478bf80aebfb65580c1"
  JUPYTERHUB_ADMIN_USERS: "admin,jupyter-admin"
  JUPYTERHUB_IMAGE: "ai-infra-singleuser:v0.3.5"
  JUPYTERHUB_NETWORK: "ai-infra-network"
  JUPYTERHUB_MEM_LIMIT: "2G"
  JUPYTERHUB_CPU_LIMIT: "1.0"
  JUPYTERHUB_IDLE_CULLER_ENABLED: "true"
  JUPYTERHUB_IDLE_TIMEOUT: "3600"
  JUPYTERHUB_CULL_TIMEOUT: "7200"
  JUPYTERHUB_AUTO_LOGIN: "true"
  JUPYTERHUB_DEV_MODE: "true"
  USE_CUSTOM_AUTH: "true"
  AI_INFRA_BACKEND_URL: "http://backend:8082"
  AI_INFRA_API_TOKEN: "ai-infra-hub-token"
  JUPYTERHUB_USE_PROXY: "true"
  JUPYTERHUB_PUBLIC_HOST: "localhost:8080"
  JUPYTERHUB_CORS_ORIGIN: "http://localhost:8080"
  JUPYTERHUB_DEBUG: "false"
  JUPYTERHUB_LOG_LEVEL: "INFO"
  JUPYTERHUB_ACCESS_LOG: "true"
  GITEA_ENABLED: "true"
  GITEA_HOST: "gitea"
  GITEA_PORT: "3000"
  GITEA_BASE_URL: "http://gitea:3000"
  GITEA_ADMIN_TOKEN: ""
  GITEA_ALIAS_ADMIN_TO: "admin"
  GITEA_ADMIN_USER: "admin"
  GITEA_ADMIN_PASSWORD: "admin123"
  GITEA_ADMIN_EMAIL: "admin@example.com"
  GITEA_ADMIN_FULL_NAME: "Administrator"
  ROOT_URL: "http://localhost:8080/gitea/"
  SUBURL: "/gitea"
  STATIC_URL_PREFIX: "/assets"
  REVERSE_PROXY_TRUSTED_PROXIES: "0.0.0.0/0,::/0"
  DISABLE_REGISTRATION: "false"
  GITEA_AUTO_CREATE: "true"
  GITEA_AUTO_UPDATE: "true"
  GITEA_SYNC_ENABLED: "true"
  GITEA_SYNC_INTERVAL_SECONDS: "600"
  INITIAL_ADMIN_USERNAME: "admin"
  SALT_MASTER_HOST: "saltstack"
  SALT_MASTER_PORT: "4505"
  SALT_RETURN_PORT: "4506"
  SALT_API_PORT: "8000"
  BACKEND_HOST: "backend"
  BACKEND_PORT: "8082"
  DB_HOST: "postgres"
  DB_PORT: "5432"
  FRONTEND_HOST: "frontend"
  FRONTEND_PORT: "80"
  NGINX_HOST: "nginx"
  NGINX_HTTP_PORT: "80"
  NGINX_HTTPS_PORT: "443"
  DEFAULT_CPU_REQUEST: "100m"
  DEFAULT_CPU_LIMIT: "500m"
  DEFAULT_MEMORY_REQUEST: "128Mi"
  DEFAULT_MEMORY_LIMIT: "512Mi"
  BACKEND_REPLICAS: "1"
  FRONTEND_REPLICAS: "1"
  NGINX_REPLICAS: "1"
  HEALTH_CHECK_ENABLED: "true"
  HEALTH_CHECK_INTERVAL: "30s"
  HEALTH_CHECK_TIMEOUT: "10s"
  HEALTH_CHECK_RETRIES: "3"
  LOG_FORMAT: "json"
  LOG_OUTPUT: "stdout"
  LOG_ROTATION_ENABLED: "true"
  LOG_MAX_SIZE: "100m"
  LOG_MAX_FILES: "10"
  DEV_MODE: "true"
  HOT_RELOAD_ENABLED: "true"
  DEBUG_PORTS_ENABLED: "true"
  ENABLE_TESTING: "false"
  TEST_DATABASE_URL: "postgresql://test:test@postgres:5432/test_db"

# JupyterHub configuration
jupyterhub:
  enabled: true
  image:
    repository: "ai-infra-jupyterhub"
    tag: "v0.3.5"
    pullPolicy: "IfNotPresent"
  service:
    type: "ClusterIP"
    port: 8000
    targetPort: 8000
  config:
    publicHost: "localhost:8080"
    corsOrigin: "http://localhost:8080"
    debug: false
    logLevel: "INFO"
    accessLog: true
  env:
    JUPYTERHUB_ADMIN_USERS: "admin,jupyter-admin"
    JUPYTERHUB_IMAGE: "ai-infra-singleuser:v0.3.5"
    JUPYTERHUB_NETWORK: "ai-infra-network"
    JUPYTERHUB_MEM_LIMIT: "2G"
    JUPYTERHUB_CPU_LIMIT: "1.0"
    JUPYTERHUB_IDLE_CULLER_ENABLED: "true"
    JUPYTERHUB_IDLE_TIMEOUT: "3600"
    JUPYTERHUB_CULL_TIMEOUT: "7200"
    JUPYTERHUB_AUTO_LOGIN: "true"
    JUPYTERHUB_DEV_MODE: "true"
    USE_CUSTOM_AUTH: "true"
    AI_INFRA_BACKEND_URL: "http://backend:8082"
    AI_INFRA_API_TOKEN: "ai-infra-hub-token"
    JUPYTERHUB_USE_PROXY: "true"
    JUPYTERHUB_PUBLIC_HOST: "localhost:8080"
    JUPYTERHUB_CORS_ORIGIN: "http://localhost:8080"
    JUPYTERHUB_DEBUG: "false"
    JUPYTERHUB_LOG_LEVEL: "INFO"
    JUPYTERHUB_ACCESS_LOG: "true"
    CONFIGPROXY_AUTH_TOKEN: "ai-infra-proxy-token-dev"
    JUPYTERHUB_CRYPT_KEY: "790031b2deeb70d780d4ccd100514b37f3c168ce80141478bf80aebfb65580c1"
  singleuser:
    image:
      repository: "ai-infra-singleuser"
      tag: "v0.3.5"
      pullPolicy: "IfNotPresent"
    resources:
      limit:
        memory: "2G"
        cpu: "1.0"
      guarantee:
        memory: "1G"
        cpu: "0.5"
    storage:
      dynamic: false  # 设为false以跳过动态PVC创建
  persistence:
    enabled: false  # 设为false以跳过persistence存储创建

# Shared storage configuration
sharedStorage:
  enabled: false  # 设为false以跳过共享存储创建

# Service account configuration
serviceAccount:
  create: true
  name: "ai-infra-matrix-sa"

# RBAC configuration
rbac:
  create: true

# Secrets configuration (for demo/testing purposes)
secrets:
  jwtSecret: "demo-jwt-secret-key"
  postgresPassword: "demo-postgres-password"
  redisPassword: "demo-redis-password"
  ldapAdminPassword: "demo-ldap-admin-password"
  ldapConfigPassword: "demo-ldap-config-password"
  giteaAdminToken: "demo-gitea-admin-token"
  minioRootPassword: "demo-minio-password"
  configproxyAuthToken: "demo-proxy-token"
  jupyterhubCryptKey: "demo-jupyterhub-crypt-key"

# PostgreSQL configuration
postgresql:
  auth:
    username: "ai_infra_user"
    database: "ai_infra_db"

# MinIO configuration
minio:
  auth:
    rootUser: "minioadmin"
  service:
    port: 9000

# OpenLDAP configuration
openldap:
  enabled: false  # 暂时禁用以简化部署
  service:
    port: 389

# phpLDAPadmin configuration  
phpldapadmin:
  enabled: false  # 暂时禁用以简化部署

# Nginx configuration
nginx:
  enabled: true  # 启用nginx服务
  image:
    repository: "ai-infra-nginx"
    tag: "v0.3.5"
    pullPolicy: "IfNotPresent"
  service:
    type: "ClusterIP"
    port: 80
    targetPort: 80

# Additional service configurations
gitea:
  enabled: false  # 暂时禁用以简化部署
  service:
    port: 3000

saltstack:
  enabled: false  # 暂时禁用以简化部署

# Ingress configuration
ingress:
  enabled: false  # 暂时禁用ingress以简化部署

# Monitoring configuration
monitoring:
  enabled: false  # 暂时禁用monitoring以简化部署

# Frontend configuration
frontend:
  enabled: true
  image:
    repository: "ai-infra-frontend"
    tag: "v0.3.5"
    pullPolicy: "IfNotPresent"
  service:
    type: "ClusterIP"
    port: 80
    targetPort: 80

# Backend configuration
backend:
  enabled: true
  image:
    repository: "ai-infra-backend"
    tag: "v0.3.5"
    pullPolicy: "IfNotPresent"
  service:
    type: "ClusterIP"
    port: 8082
    targetPort: 8082
  env:
    JWT_SECRET: "ai-infra-secret-key-change-in-dev"
    JWT_EXPIRY: "24h"
    JWT_REFRESH_EXPIRY: "168h"
    SESSION_SECRET: "ai-infra-session-secret-key"
    SESSION_TIMEOUT: "86400"
    CONFIGPROXY_AUTH_TOKEN: "ai-infra-proxy-token-dev"
    JUPYTERHUB_CRYPT_KEY: "790031b2deeb70d780d4ccd100514b37f3c168ce80141478bf80aebfb65580c1"

# Backend Init Job configuration
backendInit:
  enabled: true
  image:
    repository: "ai-infra-backend"
    tag: "v0.3.5"
    pullPolicy: "IfNotPresent"
