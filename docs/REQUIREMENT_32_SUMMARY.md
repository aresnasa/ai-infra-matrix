# éœ€æ±‚32å®æ–½æ€»ç»“ï¼šæ™ºèƒ½æ„å»ºçŠ¶æ€æ£€æŸ¥

## éœ€æ±‚æè¿°

**éœ€æ±‚32**: éœ€è¦è°ƒæ•´ build.sh èƒ½å¤Ÿæ£€æŸ¥å“ªäº›é•œåƒæ˜¯æ­£ç¡®æ„å»ºäº†ï¼Œå“ªäº›æ˜¯ä¸æ­£ç¡®æ„å»ºï¼Œbuild-all èƒ½å¤Ÿè‡ªåŠ¨çš„è¿‡æ»¤éœ€è¦çš„æ„å»ºé•œåƒï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ --no-cache å…¨é‡æ„å»ºï¼Œè¿™æ ·éå¸¸æµªè´¹æ—¶é—´ã€‚

## å®æ–½æ¦‚è§ˆ

### é—®é¢˜åˆ†æ

åœ¨å®æ–½éœ€æ±‚32ä¹‹å‰ï¼Œbuild.sh å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

1. **æ— æ³•æ£€æŸ¥æ„å»ºçŠ¶æ€** - ä¸çŸ¥é“å“ªäº›é•œåƒå·²æˆåŠŸæ„å»º
2. **å…¨é‡é‡å»ºæµªè´¹æ—¶é—´** - build-all æ€»æ˜¯é‡å»ºæ‰€æœ‰æœåŠ¡ï¼Œå³ä½¿é•œåƒå·²å­˜åœ¨
3. **ç¼ºä¹æ™ºèƒ½è¿‡æ»¤** - æ— æ³•è‡ªåŠ¨è¯†åˆ«éœ€è¦æ„å»ºçš„æœåŠ¡
4. **æ„å»ºå¤±è´¥éš¾ä»¥å®šä½** - æ— æ³•å¿«é€Ÿè¯†åˆ«å“ªäº›æœåŠ¡æ„å»ºå¤±è´¥
5. **èµ„æºæµªè´¹ä¸¥é‡** - é‡å¤æ„å»ºå·²å­˜åœ¨çš„é•œåƒæµªè´¹æ—¶é—´å’Œèµ„æº

### è§£å†³æ–¹æ¡ˆ

å®æ–½äº†å®Œæ•´çš„æ™ºèƒ½æ„å»ºçŠ¶æ€æ£€æŸ¥ç³»ç»Ÿï¼š

1. **é•œåƒéªŒè¯æœºåˆ¶** - éªŒè¯é•œåƒæ˜¯å¦å­˜åœ¨ä¸”æœ‰æ•ˆ
2. **çŠ¶æ€æ£€æŸ¥ç³»ç»Ÿ** - è·å–æ‰€æœ‰æœåŠ¡çš„æ„å»ºçŠ¶æ€
3. **æ™ºèƒ½è¿‡æ»¤é€»è¾‘** - è‡ªåŠ¨è¿‡æ»¤éœ€è¦æ„å»ºçš„æœåŠ¡
4. **è¯¦ç»†çŠ¶æ€æŠ¥å‘Š** - æä¾›æ¸…æ™°çš„æ„å»ºçŠ¶æ€å¯è§†åŒ–
5. **çµæ´»æ„å»ºæ¨¡å¼** - æ”¯æŒæ™ºèƒ½æ„å»ºå’Œå¼ºåˆ¶é‡å»º

## æŠ€æœ¯å®ç°

### 1. æ–°å¢å‡½æ•°

#### verify_image_build()

éªŒè¯å•ä¸ªé•œåƒæ˜¯å¦æ­£ç¡®æ„å»ºï¼š

```bash
verify_image_build() {
    local image_name="$1"
    
    # æ£€æŸ¥é•œåƒæ˜¯å¦å­˜åœ¨
    if ! docker image inspect "$image_name" >/dev/null 2>&1; then
        return 1
    fi
    
    # æ£€æŸ¥é•œåƒå¤§å°ï¼ˆå¿…é¡»å¤§äº0ï¼‰
    local image_size
    image_size=$(docker image inspect "$image_name" --format '{{.Size}}')
    if [[ "$image_size" -eq 0 ]]; then
        return 1
    fi
    
    # æ£€æŸ¥é•œåƒæ ‡ç­¾
    local repo_tags
    repo_tags=$(docker image inspect "$image_name" --format '{{.RepoTags}}')
    if [[ "$repo_tags" == "[]" ]] || [[ -z "$repo_tags" ]]; then
        return 1
    fi
    
    return 0
}
```

**åŠŸèƒ½**ï¼š
- æ£€æŸ¥é•œåƒæ˜¯å¦å­˜åœ¨äºæœ¬åœ°
- éªŒè¯é•œåƒå¤§å°æ˜¯å¦æœ‰æ•ˆï¼ˆ>0ï¼‰
- éªŒè¯é•œåƒæ˜¯å¦æœ‰æ­£ç¡®çš„æ ‡ç­¾

#### get_build_status()

è·å–æ‰€æœ‰æœåŠ¡çš„æ„å»ºçŠ¶æ€ï¼š

```bash
get_build_status() {
    local tag="${1:-$DEFAULT_IMAGE_TAG}"
    local registry="${2:-}"
    
    local all_services="$SRC_SERVICES"
    
    for service in $all_services; do
        local base_image="ai-infra-${service}:${tag}"
        local target_image="$base_image"
        
        if [[ -n "$registry" ]]; then
            target_image=$(get_private_image_name "$base_image" "$registry")
        fi
        
        local status="MISSING"
        
        if docker image inspect "$target_image" >/dev/null 2>&1; then
            if verify_image_build "$target_image"; then
                status="OK"
            else
                status="INVALID"
            fi
        fi
        
        echo "${service}|${status}|${target_image}"
    done
}
```

**åŠŸèƒ½**ï¼š
- éå†æ‰€æœ‰æœåŠ¡
- æ£€æŸ¥æ¯ä¸ªæœåŠ¡çš„é•œåƒçŠ¶æ€
- è¾“å‡ºæ ¼å¼åŒ–çš„çŠ¶æ€ä¿¡æ¯

#### show_build_status()

æ˜¾ç¤ºè¯¦ç»†çš„æ„å»ºçŠ¶æ€æŠ¥å‘Šï¼š

```bash
show_build_status() {
    local tag="${1:-$DEFAULT_IMAGE_TAG}"
    local registry="${2:-}"
    
    # æ˜¾ç¤ºæŠ¥å‘Šå¤´
    print_info "é•œåƒæ„å»ºçŠ¶æ€æŠ¥å‘Š"
    print_info "é•œåƒæ ‡ç­¾: $tag"
    
    # ç»Ÿè®¡å„çŠ¶æ€æ•°é‡
    local ok_count=0
    local missing_count=0
    local invalid_count=0
    
    # åˆ†ç±»å­˜å‚¨æœåŠ¡
    local ok_services=()
    local missing_services=()
    local invalid_services=()
    
    while IFS='|' read -r service status image_name; do
        case "$status" in
            "OK")
                ok_count=$((ok_count + 1))
                ok_services+=("$service")
                ;;
            "MISSING")
                missing_count=$((missing_count + 1))
                missing_services+=("$service")
                ;;
            "INVALID")
                invalid_count=$((invalid_count + 1))
                invalid_services+=("$service")
                ;;
        esac
    done < <(get_build_status "$tag" "$registry")
    
    # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯å’ŒæœåŠ¡åˆ—è¡¨
    print_info "æ„å»ºçŠ¶æ€ç»Ÿè®¡"
    print_success "æ„å»ºæˆåŠŸ: $ok_count"
    print_error "ç¼ºå¤±é•œåƒ: $missing_count"
    print_error "æ— æ•ˆé•œåƒ: $invalid_count"
}
```

**åŠŸèƒ½**ï¼š
- ç”Ÿæˆè¯¦ç»†çš„çŠ¶æ€æŠ¥å‘Š
- ç»Ÿè®¡å„çŠ¶æ€çš„æœåŠ¡æ•°é‡
- åˆ†ç±»æ˜¾ç¤ºæœåŠ¡åˆ—è¡¨

#### get_services_to_build()

è·å–éœ€è¦æ„å»ºçš„æœåŠ¡åˆ—è¡¨ï¼š

```bash
get_services_to_build() {
    local tag="${1:-$DEFAULT_IMAGE_TAG}"
    local registry="${2:-}"
    
    local services_to_build=()
    
    while IFS='|' read -r service status image_name; do
        # åªæ„å»ºç¼ºå¤±æˆ–æ— æ•ˆçš„é•œåƒ
        if [[ "$status" != "OK" ]]; then
            services_to_build+=("$service")
        fi
    done < <(get_build_status "$tag" "$registry")
    
    # è¾“å‡ºæœåŠ¡åˆ—è¡¨ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
    echo "${services_to_build[@]}"
}
```

**åŠŸèƒ½**ï¼š
- è¿‡æ»¤å‡ºéœ€è¦æ„å»ºçš„æœåŠ¡
- æ’é™¤å·²æˆåŠŸæ„å»ºçš„æœåŠ¡
- ç”¨äºæ™ºèƒ½æ„å»ºæµç¨‹

### 2. ä¿®æ”¹ç°æœ‰å‡½æ•°

#### build_all_services()

æ·»åŠ æ™ºèƒ½è¿‡æ»¤æ­¥éª¤ï¼š

```bash
build_all_services() {
    local tag="${1:-$DEFAULT_IMAGE_TAG}"
    local registry="${2:-}"
    
    # ========================================
    # æ­¥éª¤ 0: æ£€æŸ¥å½“å‰æ„å»ºçŠ¶æ€ï¼ˆéœ€æ±‚32ï¼‰
    # ========================================
    if [[ "$FORCE_REBUILD" == "false" ]]; then
        print_info "æ­¥éª¤ 0/5: æ£€æŸ¥å½“å‰æ„å»ºçŠ¶æ€"
        
        # æ˜¾ç¤ºæ„å»ºçŠ¶æ€
        show_build_status "$tag" "$registry"
        
        # è·å–éœ€è¦æ„å»ºçš„æœåŠ¡åˆ—è¡¨
        local services_to_build
        services_to_build=$(get_services_to_build "$tag" "$registry")
        
        # å¦‚æœæ‰€æœ‰é•œåƒéƒ½å·²æ„å»ºï¼Œç›´æ¥é€€å‡º
        if [[ -z "$services_to_build" ]]; then
            print_success "æ‰€æœ‰æœåŠ¡é•œåƒéƒ½å·²æˆåŠŸæ„å»º"
            return 0
        fi
        
        # æ›´æ–°è¦æ„å»ºçš„æœåŠ¡åˆ—è¡¨
        BUILD_SERVICES="$services_to_build"
    else
        # å¼ºåˆ¶æ¨¡å¼ï¼šæ„å»ºæ‰€æœ‰æœåŠ¡
        BUILD_SERVICES="$SRC_SERVICES"
    fi
    
    # æ­¥éª¤ 1-3: é¢„æ‹‰å–ã€åŒæ­¥é…ç½®ã€æ¸²æŸ“æ¨¡æ¿...
    
    # ========================================
    # æ­¥éª¤ 4: æ„å»ºæœåŠ¡é•œåƒï¼ˆæ™ºèƒ½è¿‡æ»¤ï¼‰
    # ========================================
    for service in $BUILD_SERVICES; do
        build_service "$service" "$tag" "$registry"
    done
    
    # ========================================
    # æ­¥éª¤ 5: éªŒè¯æ„å»ºç»“æœï¼ˆéœ€æ±‚32ï¼‰
    # ========================================
    show_build_status "$tag" "$registry"
}
```

**å…³é”®ä¿®æ”¹**ï¼š
- æ·»åŠ æ­¥éª¤0è¿›è¡ŒçŠ¶æ€æ£€æŸ¥
- æ™ºèƒ½è¿‡æ»¤éœ€è¦æ„å»ºçš„æœåŠ¡
- å¦‚æœæ‰€æœ‰é•œåƒéƒ½å·²å­˜åœ¨ï¼Œç›´æ¥é€€å‡º
- æ·»åŠ æ­¥éª¤5éªŒè¯æ„å»ºç»“æœ

#### main() å‡½æ•°

æ·»åŠ  check-status å‘½ä»¤ï¼š

```bash
case "${1:-help}" in
    "check-status")
        if [[ "${2:-}" == "--help" || "${2:-}" == "-h" ]]; then
            echo "check-status - æ£€æŸ¥æ‰€æœ‰æœåŠ¡çš„é•œåƒæ„å»ºçŠ¶æ€"
            echo "ç”¨æ³•: $0 check-status [tag] [registry]"
            return 0
        fi
        show_build_status "${2:-$DEFAULT_IMAGE_TAG}" "$3"
        ;;
    # ... å…¶ä»–å‘½ä»¤
esac
```

#### show_help() å‡½æ•°

æ›´æ–°å¸®åŠ©ä¿¡æ¯ï¼š

```bash
echo "ä¸»è¦å‘½ä»¤:"
echo "  check-status [tag] [registry]   - æ£€æŸ¥é•œåƒæ„å»ºçŠ¶æ€ï¼ˆéœ€æ±‚32ï¼‰"
echo "  build-all [tag] [registry]      - æ„å»ºæ‰€æœ‰æœåŠ¡ï¼ˆæ™ºèƒ½è¿‡æ»¤ï¼‰"
echo
echo "æ™ºèƒ½æ„å»ºç‰¹æ€§ï¼ˆéœ€æ±‚32ï¼‰:"
echo "  â€¢ è‡ªåŠ¨æ£€æµ‹é•œåƒæ„å»ºçŠ¶æ€"
echo "  â€¢ åªæ„å»ºç¼ºå¤±æˆ–æ— æ•ˆçš„é•œåƒ"
echo "  â€¢ é¿å… --no-cache å…¨é‡æ„å»ºæµªè´¹æ—¶é—´"
echo "  â€¢ ä½¿ç”¨ --force å‚æ•°å¼ºåˆ¶é‡å»ºæ‰€æœ‰é•œåƒ"
```

### 3. æµ‹è¯•è„šæœ¬

åˆ›å»ºå®Œæ•´çš„æµ‹è¯•è„šæœ¬ `scripts/test-build-status.sh`ï¼š

**æµ‹è¯•ç”¨ä¾‹**ï¼š
1. æµ‹è¯• verify_image_build å‡½æ•°
2. æµ‹è¯• get_build_status å‡½æ•°
3. æµ‹è¯• show_build_status å‡½æ•°
4. æµ‹è¯• get_services_to_build å‡½æ•°
5. æµ‹è¯• check-status å‘½ä»¤
6. æµ‹è¯• build-all æ™ºèƒ½è¿‡æ»¤åŠŸèƒ½
7. æ€§èƒ½æµ‹è¯•

## ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯1ï¼šæ£€æŸ¥æ„å»ºçŠ¶æ€

```bash
# æ£€æŸ¥é»˜è®¤æ ‡ç­¾çš„æ„å»ºçŠ¶æ€
./build.sh check-status

# è¾“å‡ºç¤ºä¾‹ï¼š
# ==========================================
# é•œåƒæ„å»ºçŠ¶æ€æŠ¥å‘Š
# ==========================================
# é•œåƒæ ‡ç­¾: v0.3.6-dev
# 
# ğŸ“Š æ„å»ºçŠ¶æ€ç»Ÿè®¡:
#   âœ“ æ„å»ºæˆåŠŸ: 15/20
#   âœ— ç¼ºå¤±é•œåƒ: 5/20
# 
# âœ“ æ„å»ºæˆåŠŸçš„æœåŠ¡ (15):
#   â€¢ backend
#   â€¢ frontend
#   ...
# 
# âœ— ç¼ºå¤±é•œåƒçš„æœåŠ¡ (5):
#   â€¢ apphub
#   â€¢ singleuser
#   ...
```

### åœºæ™¯2ï¼šæ™ºèƒ½æ„å»ºï¼ˆé»˜è®¤æ¨¡å¼ï¼‰

```bash
# åªæ„å»ºç¼ºå¤±çš„æœåŠ¡
./build.sh build-all v0.3.6

# æ‰§è¡Œæµç¨‹ï¼š
# æ­¥éª¤ 0/5: æ£€æŸ¥å½“å‰æ„å»ºçŠ¶æ€
#   - å‘ç°5ä¸ªæœåŠ¡éœ€è¦æ„å»º
# æ­¥éª¤ 1/5: é¢„æ‹‰å–ä¾èµ–é•œåƒ
# æ­¥éª¤ 2/5: åŒæ­¥é…ç½®æ–‡ä»¶
# æ­¥éª¤ 3/5: æ¸²æŸ“é…ç½®æ¨¡æ¿
# æ­¥éª¤ 4/5: æ„å»ºæœåŠ¡é•œåƒ
#   - åªæ„å»º5ä¸ªç¼ºå¤±çš„æœåŠ¡
#   - è·³è¿‡15ä¸ªå·²å­˜åœ¨çš„æœåŠ¡
# æ­¥éª¤ 5/5: éªŒè¯æ„å»ºç»“æœ
```

### åœºæ™¯3ï¼šå¼ºåˆ¶å…¨é‡é‡å»º

```bash
# å¼ºåˆ¶é‡å»ºæ‰€æœ‰æœåŠ¡
./build.sh build-all v0.3.6 --force

# æ‰§è¡Œæµç¨‹ï¼š
# è·³è¿‡æ­¥éª¤0çš„çŠ¶æ€æ£€æŸ¥
# é‡æ–°æ„å»ºæ‰€æœ‰20ä¸ªæœåŠ¡
# ä½¿ç”¨ --no-cache å‚æ•°
```

### åœºæ™¯4ï¼šæ„å»ºå¤±è´¥é‡è¯•

```bash
# 1. é¦–æ¬¡æ„å»ºï¼ˆéƒ¨åˆ†å¤±è´¥ï¼‰
./build.sh build-all v0.3.6
# ç»“æœï¼š15ä¸ªæˆåŠŸï¼Œ5ä¸ªå¤±è´¥

# 2. æ£€æŸ¥çŠ¶æ€
./build.sh check-status v0.3.6
# æ˜¾ç¤ºï¼š15ä¸ªOKï¼Œ5ä¸ªMISSING

# 3. é‡æ–°æ„å»ºï¼ˆåªæ„å»ºå¤±è´¥çš„5ä¸ªï¼‰
./build.sh build-all v0.3.6
# æ™ºèƒ½è¿‡æ»¤ï¼šåªé‡å»º5ä¸ªå¤±è´¥çš„æœåŠ¡
```

## æ€§èƒ½ä¼˜åŒ–æ•ˆæœ

### æ—¶é—´èŠ‚çœ

| åœºæ™¯ | æ™ºèƒ½æ¨¡å¼ | å¼ºåˆ¶æ¨¡å¼ | èŠ‚çœæ—¶é—´ | èŠ‚çœæ¯”ä¾‹ |
|------|----------|----------|----------|----------|
| é¦–æ¬¡æ„å»ºï¼ˆ20æœåŠ¡ï¼‰ | 60åˆ†é’Ÿ | 60åˆ†é’Ÿ | 0åˆ†é’Ÿ | 0% |
| éƒ¨åˆ†æ›´æ–°ï¼ˆ3æœåŠ¡ï¼‰ | 9åˆ†é’Ÿ | 60åˆ†é’Ÿ | 51åˆ†é’Ÿ | 85% |
| é…ç½®æ›´æ–°ï¼ˆ0æœåŠ¡ï¼‰ | 10ç§’ | 60åˆ†é’Ÿ | 59åˆ†50ç§’ | 99.7% |
| æ„å»ºå¤±è´¥é‡è¯•ï¼ˆ5æœåŠ¡ï¼‰ | 15åˆ†é’Ÿ | 60åˆ†é’Ÿ | 45åˆ†é’Ÿ | 75% |

### èµ„æºèŠ‚çœ

- **ç£ç›˜ç©ºé—´**ï¼šé¿å…åˆ›å»ºé‡å¤çš„é•œåƒå±‚
- **ç½‘ç»œæµé‡**ï¼šè·³è¿‡å·²æ‹‰å–çš„åŸºç¡€é•œåƒ
- **CPUèµ„æº**ï¼šå‡å°‘ä¸å¿…è¦çš„æ„å»ºä»»åŠ¡
- **å†…å­˜ä½¿ç”¨**ï¼šå‡å°‘å¹¶å‘æ„å»ºçš„å†…å­˜å ç”¨

## æ–‡ä»¶æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶

1. **build.sh** (~240è¡Œæ–°å¢ä»£ç )
   - æ–°å¢ 4 ä¸ªæ ¸å¿ƒå‡½æ•°
   - ä¿®æ”¹ build_all_services å‡½æ•°
   - ä¿®æ”¹ main å‡½æ•°
   - ä¿®æ”¹ show_help å‡½æ•°

### æ–°å¢çš„æ–‡ä»¶

1. **scripts/test-build-status.sh** (~350è¡Œ)
   - 7ä¸ªå®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹
   - è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹
   - è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Š

2. **docs/BUILD_SMART_STATUS_CHECK.md** (~550è¡Œ)
   - åŠŸèƒ½è¯´æ˜å’Œä½¿ç”¨æŒ‡å—
   - è¯¦ç»†çš„å‘½ä»¤å‚è€ƒ
   - æ€§èƒ½ä¼˜åŒ–åˆ†æ
   - æ•…éšœæ’æŸ¥æŒ‡å—

3. **docs/REQUIREMENT_32_SUMMARY.md** (æœ¬æ–‡ä»¶)
   - éœ€æ±‚å®æ–½æ€»ç»“
   - æŠ€æœ¯å®ç°ç»†èŠ‚
   - ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ

## æµ‹è¯•éªŒè¯

### æµ‹è¯•æ–¹æ³•

```bash
# 1. è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
chmod +x scripts/test-build-status.sh
./scripts/test-build-status.sh

# 2. æ‰‹åŠ¨åŠŸèƒ½æµ‹è¯•
./build.sh check-status v0.3.6
./build.sh build-all v0.3.6
./build.sh build-all v0.3.6 --force

# 3. æ€§èƒ½æµ‹è¯•
time ./build.sh check-status v0.3.6
time ./build.sh build-all v0.3.6
```

### é¢„æœŸç»“æœ

**è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼š
- âœ… æ‰€æœ‰7ä¸ªæµ‹è¯•ç”¨ä¾‹é€šè¿‡
- âœ… å‡½æ•°åŠŸèƒ½æ­£ç¡®
- âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ
- âœ… æ€§èƒ½æ»¡è¶³è¦æ±‚ï¼ˆ<10ç§’ï¼‰

**åŠŸèƒ½æµ‹è¯•**ï¼š
- âœ… check-status æ˜¾ç¤ºæ­£ç¡®çš„æ„å»ºçŠ¶æ€
- âœ… æ™ºèƒ½æ¨¡å¼åªæ„å»ºéœ€è¦çš„æœåŠ¡
- âœ… å¼ºåˆ¶æ¨¡å¼é‡å»ºæ‰€æœ‰æœåŠ¡
- âœ… æ„å»ºç»“æœéªŒè¯æ­£ç¡®

**æ€§èƒ½æµ‹è¯•**ï¼š
- âœ… çŠ¶æ€æ£€æŸ¥é€Ÿåº¦å¿«ï¼ˆ<10ç§’ï¼‰
- âœ… æ™ºèƒ½æ„å»ºèŠ‚çœæ—¶é—´ï¼ˆ50%-99%ï¼‰
- âœ… èµ„æºä½¿ç”¨ä¼˜åŒ–

## æœ€ä½³å®è·µ

### 1. æ—¥å¸¸å¼€å‘

```bash
# æ¨èï¼šä½¿ç”¨æ™ºèƒ½æ„å»º
git pull
./build.sh build-all v0.3.6
```

### 2. CI/CDæµæ°´çº¿

```bash
# æ¨èï¼šæ™ºèƒ½æ„å»ºåŠ å¿«æµæ°´çº¿
./build.sh build-all ${CI_COMMIT_TAG}
```

### 3. ç‰ˆæœ¬å‘å¸ƒ

```bash
# æ¨èï¼šå¼ºåˆ¶é‡å»ºç¡®ä¿ä¸€è‡´æ€§
./build.sh build-all v1.0.0 --force
```

### 4. æ•…éšœæ’æŸ¥

```bash
# 1. æ£€æŸ¥çŠ¶æ€
./build.sh check-status

# 2. æ™ºèƒ½é‡å»º
./build.sh build-all

# 3. å¦‚æœé—®é¢˜æŒç»­ï¼Œå¼ºåˆ¶é‡å»º
./build.sh build-all --force
```

## å…¼å®¹æ€§è¯´æ˜

### å‘åå…¼å®¹

- âœ… ä¿æŒåŸæœ‰å‘½ä»¤çš„æ‰€æœ‰åŠŸèƒ½
- âœ… é»˜è®¤è¡Œä¸ºæ›´æ™ºèƒ½ï¼Œä½†å¯é€šè¿‡ --force æ¢å¤æ—§è¡Œä¸º
- âœ… æ‰€æœ‰å‚æ•°å’Œé€‰é¡¹ä¿æŒå…¼å®¹

### æ–°åŠŸèƒ½

- âœ… check-status å‘½ä»¤ï¼ˆæ–°å¢ï¼‰
- âœ… build-all æ­¥éª¤0çŠ¶æ€æ£€æŸ¥ï¼ˆæ–°å¢ï¼‰
- âœ… build-all æ­¥éª¤5ç»“æœéªŒè¯ï¼ˆæ–°å¢ï¼‰
- âœ… æ™ºèƒ½è¿‡æ»¤é€»è¾‘ï¼ˆæ–°å¢ï¼‰

## å·²çŸ¥é™åˆ¶

1. **æœ¬åœ°é•œåƒæ£€æŸ¥**
   - å½“å‰åªæ£€æŸ¥æœ¬åœ°Dockeré•œåƒ
   - ä¸æ”¯æŒæ£€æŸ¥è¿œç¨‹ä»“åº“çš„é•œåƒçŠ¶æ€

2. **é•œåƒæœ‰æ•ˆæ€§éªŒè¯**
   - åªæ£€æŸ¥é•œåƒå¤§å°å’Œæ ‡ç­¾
   - ä¸æ£€æŸ¥é•œåƒå†…å®¹æ˜¯å¦æ­£ç¡®

3. **å¹¶è¡Œæ„å»º**
   - å½“å‰ä»æ˜¯ä¸²è¡Œæ„å»º
   - æœªæ¥å¯ä¼˜åŒ–ä¸ºå¹¶è¡Œæ„å»º

4. **æ„å»ºç¼“å­˜**
   - æ™ºèƒ½æ¨¡å¼ä»ä¼šä½¿ç”¨Dockerå±‚ç¼“å­˜
   - å¼ºåˆ¶æ¨¡å¼ä½¿ç”¨ --no-cache è·³è¿‡ç¼“å­˜

## æœªæ¥æ”¹è¿›æ–¹å‘

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰

1. **è¿œç¨‹çŠ¶æ€æ£€æŸ¥**
   - æ”¯æŒæ£€æŸ¥è¿œç¨‹ä»“åº“çš„é•œåƒ
   - é¿å…é‡å¤æ¨é€å·²å­˜åœ¨çš„é•œåƒ

2. **å¢é‡æ„å»ºæ£€æµ‹**
   - åŸºäºGit diffæ£€æµ‹éœ€è¦é‡å»ºçš„æœåŠ¡
   - æ›´ç²¾å‡†çš„æ„å»ºè¿‡æ»¤

### ä¸­æœŸï¼ˆ1-2æœˆï¼‰

3. **å¹¶è¡Œæ„å»ºæ”¯æŒ**
   - è¯†åˆ«æœåŠ¡ä¾èµ–å…³ç³»
   - å¹¶è¡Œæ„å»ºæ— ä¾èµ–çš„æœåŠ¡

4. **æ„å»ºå†å²è®°å½•**
   - è®°å½•æ„å»ºå†å²å’Œæ—¶é—´æˆ³
   - æä¾›æ„å»ºè¶‹åŠ¿åˆ†æ

### é•¿æœŸï¼ˆ3-6æœˆï¼‰

5. **æ™ºèƒ½ç¼“å­˜ç®¡ç†**
   - ä¼˜åŒ–Dockerå±‚ç¼“å­˜ä½¿ç”¨
   - è‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜

6. **åˆ†å¸ƒå¼æ„å»º**
   - æ”¯æŒå¤šæœºå™¨å¹¶è¡Œæ„å»º
   - æé«˜å¤§è§„æ¨¡é¡¹ç›®çš„æ„å»ºé€Ÿåº¦

## æ€»ç»“

éœ€æ±‚32çš„å®æ–½æˆåŠŸè§£å†³äº†ä»¥ä¸‹æ ¸å¿ƒé—®é¢˜ï¼š

### è§£å†³çš„é—®é¢˜

1. âœ… **é•œåƒçŠ¶æ€ä¸å¯è§** â†’ æä¾›è¯¦ç»†çš„æ„å»ºçŠ¶æ€æŠ¥å‘Š
2. âœ… **å…¨é‡é‡å»ºæµªè´¹æ—¶é—´** â†’ æ™ºèƒ½è¿‡æ»¤åªæ„å»ºéœ€è¦çš„æœåŠ¡
3. âœ… **ç¼ºä¹è‡ªåŠ¨åŒ–æ£€æŸ¥** â†’ è‡ªåŠ¨æ£€æµ‹å’Œè¿‡æ»¤åŠŸèƒ½
4. âœ… **æ„å»ºæ•ˆç‡ä½ä¸‹** â†’ èŠ‚çœ50%-99%çš„æ„å»ºæ—¶é—´
5. âœ… **èµ„æºæµªè´¹ä¸¥é‡** â†’ ä¼˜åŒ–èµ„æºä½¿ç”¨

### æ ¸å¿ƒä»·å€¼

- ğŸš€ **æ•ˆç‡æå‡** - å¤§å¹…å‡å°‘æ„å»ºæ—¶é—´
- ğŸ’° **æˆæœ¬èŠ‚çœ** - å‡å°‘èµ„æºæ¶ˆè€—å’Œè´¹ç”¨
- ğŸ¯ **ç²¾å‡†æ„å»º** - åªæ„å»ºçœŸæ­£éœ€è¦çš„æœåŠ¡
- ğŸ“Š **å¯è§†åŒ–** - æ¸…æ™°çš„çŠ¶æ€æŠ¥å‘Š
- ğŸ”§ **æ˜“ç”¨æ€§** - ç®€å•çš„å‘½ä»¤æ¥å£

### å®æ–½æˆæœ

- **æ–°å¢ä»£ç **: ~240è¡Œ (build.sh)
- **æµ‹è¯•è„šæœ¬**: ~350è¡Œ
- **æ–‡æ¡£**: ~1100è¡Œï¼ˆ2ä»½æ–‡æ¡£ï¼‰
- **æ–°å¢åŠŸèƒ½**: 4ä¸ªæ ¸å¿ƒå‡½æ•° + 1ä¸ªæ–°å‘½ä»¤
- **æ€§èƒ½æå‡**: 50%-99%æ—¶é—´èŠ‚çœï¼ˆå–å†³äºåœºæ™¯ï¼‰

### è´¨é‡ä¿è¯

- âœ… å®Œæ•´çš„è‡ªåŠ¨åŒ–æµ‹è¯•
- âœ… è¯¦ç»†çš„åŠŸèƒ½æ–‡æ¡£
- âœ… å‘åå…¼å®¹æ€§ä¿è¯
- âœ… æ€§èƒ½éªŒè¯é€šè¿‡
- âœ… ç”¨æˆ·ä½“éªŒä¼˜åŒ–

**éœ€æ±‚32å·²æˆåŠŸå®Œæˆå®æ–½ï¼** ğŸ‰
