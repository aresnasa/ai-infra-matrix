# ====================================================================
# AI Infrastructure Matrix - 统一环境变量配置
# 版本: v3.1.0
# 作者: AI Infrastructure Team
# 说明: 此文件包含所有服务的环境变量配置，支持Docker Compose和Helm部署

# ==================== 基础配置 ====================
# 项目名称
COMPOSE_PROJECT_NAME=ai-infra-matrix
# 镜像版本标签
IMAGE_TAG=v0.3.6-dev
# 私有镜像仓库地址 (开发环境可选，CI/CD环境必须)
PRIVATE_REGISTRY=
# GitHub 代理配置 (可选)
# 用于从 GitHub 下载包时使用代理，留空则直连 GitHub
# 示例: GITHUB_PROXY=http://192.168.0.200:7890
GITHUB_PROXY=http://192.168.0.200:7890
# 环境类型 (development/staging/production)
BUILD_ENV=development
DEBUG_MODE=true
LOG_LEVEL=debug
# 环境文件配置
ENV_FILE=.env
# 时区设置
TZ=Asia/Shanghai
# NTP 时钟源配置 (用于时间同步，可自定义)
NTP_SERVER=ntp.aliyun.com
NTP_SERVER_BACKUP=cn.pool.ntp.org
# ==================== 动态域名配置 ====================
# 外部访问主机 (自动检测或手动设置)
EXTERNAL_HOST=${EXTERNAL_HOST}
# 域名配置 (可设置为IP或域名)
DOMAIN=${EXTERNAL_HOST}
# 主要服务端口 (修改此端口即可重新部署整个服务栈)
EXTERNAL_PORT=${EXTERNAL_PORT}
# 服务协议
EXTERNAL_SCHEME=${EXTERNAL_SCHEME}
# 服务端口映射 (基于 EXTERNAL_PORT 自动计算)
# 主入口: EXTERNAL_PORT (8080)
# JupyterHub: EXTERNAL_PORT + 8 (8088)  
# Gitea: EXTERNAL_PORT - 5070 (3010)
# AppHub包仓库: EXTERNAL_PORT + 45354 (53434) - 用于内部包管理服务
# HTTPS: EXTERNAL_PORT + 363 (8443)
# 调试端口: EXTERNAL_PORT - 79 (8001)
NGINX_PORT=${EXTERNAL_PORT}
JUPYTERHUB_EXTERNAL_PORT=${JUPYTERHUB_PORT}
GITEA_EXTERNAL_PORT=${GITEA_PORT}
APPHUB_PORT=${APPHUB_PORT}
# AppHub内部访问URL（容器间通信使用Docker网络，而非物理机IP）
APPHUB_URL=http://apphub:80
HTTPS_PORT=${HTTPS_PORT}
DEBUG_PORT=${DEBUG_PORT}
# ==================== 数据库配置 ====================
# PostgreSQL 配置
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=ai_infra_matrix
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-postgres-password
# PostgreSQL JupyterHub 数据库
JUPYTERHUB_DB_NAME=jupyterhub_db
JUPYTERHUB_DB_USER=postgres
JUPYTERHUB_DB_PASSWORD=postgres
# Gitea 数据库配置
GITEA_DB_TYPE=postgres
GITEA_DB_HOST=postgres:5432
GITEA_DB_NAME=gitea
GITEA_DB_USER=gitea
GITEA_DB_PASSWD=gitea-password
# OceanBase 数据库配置
OB_HOST=oceanbase
OB_PORT=2881
OB_USER=root
OB_PASSWORD=
OB_DATABASE=aimatrix
OB_INIT_DIR=./data/oceanbase/init.d
# MySQL 数据库配置 (用于SLURM等服务)
MYSQL_HOST=mysql
MYSQL_PORT=3306
MYSQL_ROOT_PASSWORD=mysql123
MYSQL_DATABASE=slurm_acct_db
MYSQL_USER=slurm
MYSQL_PASSWORD=slurm123
# ==================== 缓存配置 ====================
# Redis 配置
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your-redis-password
REDIS_DB=0
REDIS_CACHE_DB=1
# ==================== LDAP 配置 ====================
# OpenLDAP 配置
LDAP_SERVER=openldap
LDAP_PORT=389
LDAP_BASE_DN=dc=ai-infra,dc=com
LDAP_BIND_DN=cn=admin,dc=ai-infra,dc=com
LDAP_ADMIN_PASSWORD=your-ldap-admin-password
LDAP_CONFIG_PASSWORD=config123
# LDAP 用户管理
LDAP_USER_BASE=ou=users,dc=ai-infra,dc=com
LDAP_GROUP_BASE=ou=groups,dc=ai-infra,dc=com
LDAP_USER_FILTER=(uid=%s)
LDAP_ADMIN_GROUP=administrators
# ==================== 存储配置 ====================
# MinIO S3 兼容存储
MINIO_HOST=minio
MINIO_PORT=9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET_DEFAULT=ai-infra
MINIO_BUCKET_GITEA=gitea
MINIO_BUCKET_JUPYTER=jupyter
MINIO_USE_SSL=false
MINIO_REGION=us-east-1
# 存储类型选择 (local/minio/s3)
STORAGE_TYPE=local
GITEA_STORAGE=local
# MinIO Web控制台配置
MINIO_CONSOLE_HOST=minio
MINIO_CONSOLE_PORT=9001
# 使用nginx代理路径，避免跨域问题
MINIO_CONSOLE_URL=${EXTERNAL_SCHEME}://${EXTERNAL_HOST}:${EXTERNAL_PORT}/minio-console/
MINIO_CONSOLE_ENABLED=true
# 对象存储iframe集成配置
OBJECT_STORAGE_IFRAME_ENABLED=true
OBJECT_STORAGE_DEFAULT_TYPE=minio
# ==================== 认证配置 ====================
# JWT 配置
JWT_SECRET=your-jwt-secret-key-change-in-production
JWT_EXPIRY=24h
JWT_REFRESH_EXPIRY=168h
# Session 配置
SESSION_SECRET=your-session-secret-key-change-in-production
SESSION_TIMEOUT=86400
# OAuth 配置 (可选)
OAUTH_ENABLED=false
OAUTH_CLIENT_ID=
OAUTH_CLIENT_SECRET=
OAUTH_REDIRECT_URL=
# ==================== AI 助手配置 ====================
# OpenAI 配置 (请替换为真实的API密钥)
OPENAI_API_KEY=sk-proj-example123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_DEFAULT_MODEL=gpt-4
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.7
# Claude 配置 (请替换为真实的API密钥)
CLAUDE_API_KEY=sk-ant-example123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
CLAUDE_BASE_URL=https://api.anthropic.com
CLAUDE_DEFAULT_MODEL=claude-3-5-sonnet-20241022
CLAUDE_MAX_TOKENS=4096
CLAUDE_TEMPERATURE=0.7
# 本地 AI 模型配置
LOCAL_AI_ENABLED=false
LOCAL_AI_BASE_URL=http://localhost:8080/v1
LOCAL_AI_DEFAULT_MODEL=llama2
# MCP (Model Context Protocol) 配置
MCP_ENABLED=false
MCP_SERVER_PATH=
MCP_SERVER_ARGS=
# DeepSeek 配置
# API Key从官网获取: https://platform.deepseek.com/
DEEPSEEK_API_KEY=sk-test-deepseek-api-key-for-testing
# Base URL: 使用 v1 端点以保持 OpenAI 兼容性（v1 与模型版本无关）
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
# DeepSeek-V3.2-Exp 模型配置
# 说明: deepseek-chat 和 deepseek-reasoner 都已升级为 DeepSeek-V3.2-Exp
# - deepseek-chat: DeepSeek-V3.2-Exp 非思考模式（快速对话）
# - deepseek-reasoner: DeepSeek-V3.2-Exp 思考模式（深度推理）
DEEPSEEK_DEFAULT_MODEL=deepseek-chat
DEEPSEEK_CHAT_MODEL=deepseek-chat
DEEPSEEK_REASONER_MODEL=deepseek-reasoner
# GLM 配置 (智谱AI)
GLM_API_KEY=
GLM_BASE_URL=https://open.bigmodel.cn/api/paas/v4
GLM_DEFAULT_MODEL=glm-4
# 通义千问配置
QWEN_API_KEY=
QWEN_BASE_URL=https://dashscope.aliyuncs.com/api/v1
QWEN_DEFAULT_MODEL=qwen-turbo
# AI 助手通用配置
AI_ASSISTANT_ENABLED=true
AI_ASSISTANT_LOG_LEVEL=info
AI_ASSISTANT_MAX_CONVERSATIONS=1000
AI_ASSISTANT_MAX_MESSAGES_PER_CONVERSATION=100
AI_ASSISTANT_DEFAULT_SYSTEM_PROMPT=你是一个智能的AI助手，请提供准确、有用的回答。
# AI 助手数据库配置 (使用主MySQL数据库)
AI_DB_HOST=mysql
AI_DB_PORT=3306
AI_DB_NAME=ai_assistant
AI_DB_USER=ai_user
AI_DB_PASSWORD=ai_password123
# 强制重新初始化AI配置 (设置为true以清理并重新创建AI配置)
FORCE_AI_REINIT=false
# 服务初始化配置
SALTSTACK_ENABLED=true
SLURM_ENABLED=true
# ==================== JupyterHub 配置 ====================
# JupyterHub 基础配置
JUPYTERHUB_HOST=jupyterhub
JUPYTERHUB_PORT=8000
CONFIGPROXY_AUTH_TOKEN=ai-infra-proxy-token-dev
JUPYTERHUB_CRYPT_KEY=790031b2deeb70d780d4ccd100514b37f3c168ce80141478bf80aebfb65580c1
JUPYTERHUB_ADMIN_USERS=admin,jupyter-admin
# JupyterHub 镜像配置
JUPYTERHUB_IMAGE=ai-infra-singleuser:v0.3.6-dev
JUPYTERHUB_NETWORK=ai-infra-network
# JupyterHub 资源限制
JUPYTERHUB_MEM_LIMIT=2G
JUPYTERHUB_CPU_LIMIT=1.0
# JupyterHub 自动清理
JUPYTERHUB_IDLE_CULLER_ENABLED=true
JUPYTERHUB_IDLE_TIMEOUT=3600
JUPYTERHUB_CULL_TIMEOUT=7200
# JupyterHub 集成配置
JUPYTERHUB_AUTO_LOGIN=true
JUPYTERHUB_DEV_MODE=true
USE_CUSTOM_AUTH=true
AI_INFRA_BACKEND_URL=http://backend:8082
AI_INFRA_API_TOKEN=ai-infra-hub-token
# JupyterHub 网络配置 (动态生成)
JUPYTERHUB_USE_PROXY=true
JUPYTERHUB_PUBLIC_HOST=${EXTERNAL_HOST}:${EXTERNAL_PORT}
JUPYTERHUB_BASE_URL=${EXTERNAL_SCHEME}://${EXTERNAL_HOST}:${EXTERNAL_PORT}/jupyter/
JUPYTERHUB_CORS_ORIGIN=${EXTERNAL_SCHEME}://${EXTERNAL_HOST}:${EXTERNAL_PORT}
# JupyterHub 调试配置
JUPYTERHUB_DEBUG=false
JUPYTERHUB_LOG_LEVEL=INFO
JUPYTERHUB_ACCESS_LOG=true
# ==================== Gitea 配置 ====================
# Gitea 基础配置
GITEA_ENABLED=true
# 内部服务访问地址（后端使用，直接访问 Gitea 容器）
GITEA_HOST=gitea
GITEA_PORT=3000
# API 基础 URL（后端直接访问内部服务，不经过 nginx 代理）
GITEA_BASE_URL=http://gitea:3000/
GITEA_ADMIN_TOKEN=your-gitea-admin-token-here
GITEA_ALIAS_ADMIN_TO=admin
# Gitea 管理员配置
GITEA_ADMIN_USER=admin
GITEA_ADMIN_PASSWORD=admin123
GITEA_ADMIN_EMAIL=admin@example.com
GITEA_ADMIN_FULL_NAME=Administrator
# Gitea URL 配置 (动态生成)
ROOT_URL=${EXTERNAL_SCHEME}://${EXTERNAL_HOST}:${EXTERNAL_PORT}/gitea/
SUBURL=/gitea
STATIC_URL_PREFIX=/gitea
# Gitea 反向代理认证
REVERSE_PROXY_TRUSTED_PROXIES=0.0.0.0/0,::/0
GITEA__auth__REVERSE_PROXY_AUTHENTICATION_USER=X-WEBAUTH-USER
GITEA__auth__REVERSE_PROXY_AUTHENTICATION_EMAIL=X-WEBAUTH-EMAIL
GITEA__auth__REVERSE_PROXY_AUTHENTICATION_FULL_NAME=X-WEBAUTH-FULLNAME
GITEA__auth__PROXY_ENABLED=true
GITEA__auth__PROXY_HEADER_NAME=X-WEBAUTH-USER
GITEA__auth__PROXY_EMAIL_HEADER=X-WEBAUTH-EMAIL
GITEA__auth__PROXY_FULL_NAME_HEADER=X-WEBAUTH-FULLNAME
# Gitea 安全配置
GITEA__security__REVERSE_PROXY_LIMIT=1
GITEA__security__REVERSE_PROXY_TRUSTED_PROXIES=0.0.0.0/0,::/0
DISABLE_REGISTRATION=false
# Gitea 自动同步配置
GITEA_AUTO_CREATE=true
GITEA_AUTO_UPDATE=true
GITEA_SYNC_ENABLED=true
GITEA_SYNC_INTERVAL_SECONDS=600
# Gitea 初始管理员
INITIAL_ADMIN_USERNAME=admin
# ==================== SaltStack 配置 ====================
# SaltStack 版本配置
SALTSTACK_VERSION=v3007.8
# ==================== 组件版本配置 ====================
# AppHub 打包的组件版本（用于离线安装）
SLURM_VERSION=25.05.4
CATEGRAF_VERSION=v0.4.22
SINGULARITY_VERSION=v4.3.4
# SaltStack Master 主机地址 (容器名或IP地址)
SALTSTACK_MASTER_HOST=saltstack
# SaltStack Master API URL (包含协议和端口) - 留空表示使用下面的协议/主机/端口组合
SALTSTACK_MASTER_URL=http://saltstack:8002
# SaltStack API 认证令牌 (可选，如果启用了API认证)
SALTSTACK_API_TOKEN=
# SaltStack Master 端口配置
SALT_MASTER_HOST=saltstack
SALT_MASTER_PORT=4505
SALT_RETURN_PORT=4506
SALT_API_PORT=8002
SALT_API_SCHEME=http
# SaltStack API 认证配置
SALT_API_USERNAME=saltapi
SALT_API_PASSWORD=your-salt-api-password
SALT_API_EAUTH=file
# ==================== SLURM 配置 ====================
# SLURM 集群配置
SLURM_CLUSTER_NAME=ai-infra-cluster
SLURM_CONTROLLER_HOST=slurm-master
SLURM_CONTROLLER_PORT=6817
SLURM_SLURMDBD_HOST=slurm-master
SLURM_SLURMDBD_PORT=6818
# SLURM 数据库配置 (使用主PostgreSQL数据库)
SLURM_DB_HOST=mysql
SLURM_DB_PORT=3306
SLURM_DB_NAME=slurm_acct_db
SLURM_DB_USER=slurm
SLURM_DB_PASSWORD=slurm123
# SLURM 认证配置
SLURM_AUTH_TYPE=auth/munge
SLURM_MUNGE_KEY=ai-infra-slurm-munge-key-dev
# SLURM 集群节点配置
SLURM_PARTITION_NAME=compute
SLURM_DEFAULT_PARTITION=compute
SLURM_NODE_PREFIX=compute
SLURM_NODE_COUNT=3
# SLURM 测试节点配置（预留空，按需配置）
SLURM_TEST_NODES=${SLURM_TEST_NODES:-}
SLURM_TEST_NODE_CPUS=4
SLURM_TEST_NODE_MEMORY=8192
# SLURM 作业配置
SLURM_MAX_JOB_COUNT=10000
SLURM_MAX_ARRAY_SIZE=1000
SLURM_DEFAULT_TIME_LIMIT=01:00:00
SLURM_MAX_TIME_LIMIT=24:00:00
# SLURM Operator 配置
SLURM_OPERATOR_ENABLED=false
SLURM_WATCH_NAMESPACE=ai-infra
SLURM_ACCOUNTING_WORKERS=4
SLURM_CONTROLLER_WORKERS=4
SLURM_LOGINSET_WORKERS=4
SLURM_NODESET_WORKERS=4
SLURM_RESTAPI_WORKERS=4
SLURM_TOKEN_WORKERS=4
SLURM_SLURMCLIENT_WORKERS=2
SLURM_LOG_LEVEL=info
SLURM_WEBHOOK_TIMEOUT=10
SLURM_WEBHOOK_LOG_LEVEL=info
# ==================== 后端服务配置 ====================
# 后端 API 配置
BACKEND_HOST=backend
BACKEND_PORT=8082
DB_HOST=postgres
DB_PORT=5432
# 前端配置
FRONTEND_HOST=frontend
FRONTEND_PORT=80
# ==================== Nginx 配置 ====================
# Nginx 服务配置
NGINX_HOST=nginx
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443
# ==================== Kubernetes 配置 (Helm 部署) ====================
# K8s 资源配置
K8S_NAMESPACE=ai-infra
K8S_STORAGE_CLASS=standard
K8S_INGRESS_ENABLED=false
K8S_LOAD_BALANCER_ENABLED=true
# 资源限制
DEFAULT_CPU_REQUEST=100m
DEFAULT_CPU_LIMIT=500m
DEFAULT_MEMORY_REQUEST=128Mi
DEFAULT_MEMORY_LIMIT=512Mi
# 副本数配置
BACKEND_REPLICAS=1
FRONTEND_REPLICAS=1
NGINX_REPLICAS=1
# ==================== 监控配置 ====================
# 健康检查配置
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3
# Nightingale 监控配置
# NIGHTINGALE_ENABLED=true  # 已废弃：Nightingale 默认总是启用
NIGHTINGALE_HOST=nightingale
NIGHTINGALE_PORT=17000
NIGHTINGALE_ALERT_PORT=19000
# 前端访问配置（React 环境变量需要 REACT_APP_ 前缀）
# 留空则使用 nginx 代理路径 /nightingale/（推荐，支持 ProxyAuth SSO）
# 如需直接访问端口，可设置 REACT_APP_NIGHTINGALE_PORT=17000
# REACT_APP_NIGHTINGALE_PORT=
REACT_APP_NIGHTINGALE_URL=
# 日志配置
LOG_FORMAT=json
LOG_OUTPUT=stdout
LOG_ROTATION_ENABLED=true
LOG_MAX_SIZE=100m
LOG_MAX_FILES=10
# ==================== 开发配置 ====================
# 开发模式配置
DEV_MODE=true
HOT_RELOAD_ENABLED=true
DEBUG_PORTS_ENABLED=true
# 测试配置
ENABLE_TESTING=false
TEST_DATABASE_URL=postgresql://test:test@postgres:5432/test_db
# 测试容器SSH密码配置（用于 docker-compose.test.yml）
TEST_SSH_PASSWORD=testpass123
TEST_ROOT_PASSWORD=rootpass123
# AI_INFRA_NETWORK_ENV=internal  # 已启用自动检测，无需手动设置
LDAP_ORGANISATION="AI Infrastructure"
LDAP_DOMAIN=ai-infra.com
PHPLDAPADMIN_HTTPS=false
USER_UID=1000
USER_GID=1000
GITEA_PROTOCOL=http
GITEA_HTTP_PORT=3000
GITEA_DATA_PATH=/data/gitea
K8S_PROXY_LISTEN=0.0.0.0:6443
K8S_PROXY_TALK=host.docker.internal:6443
K8S_PROXY_PRE_RESOLVE=0
K8S_PROXY_VERBOSE=1
BUILDKIT_INLINE_CACHE=1
# AI_INFRA_NETWORK_ENV=internal
AI_INFRA_NETWORK_ENV=external
ENCRYPTION_KEY=KkdPSFw75s3eWagCYc454dSrhIcMyuJL
# ==================== Prometheus 监控配置 ====================
# Prometheus 服务配置
PROMETHEUS_ENABLED=true
PROMETHEUS_HOST=prometheus
PROMETHEUS_PORT=9090
PROMETHEUS_EXTERNAL_PORT=9090
PROMETHEUS_EXTERNAL_URL=http://192.168.18.114:9090
# Prometheus 数据保留配置
PROMETHEUS_RETENTION_DAYS=30
PROMETHEUS_RETENTION_SIZE=50GB
PROMETHEUS_SCRAPE_INTERVAL=30s
PROMETHEUS_SCRAPE_TIMEOUT=10s
PROMETHEUS_EVALUATION_INTERVAL=15s
# Prometheus 存储配置
PROMETHEUS_DATA_PATH=/prometheus
PROMETHEUS_CONFIG_PATH=/etc/prometheus
# ==================== Grafana 配置 ====================
# Grafana 服务配置
GRAFANA_ENABLED=true
GRAFANA_HOST=grafana
GRAFANA_PORT=3000
GRAFANA_EXTERNAL_PORT=3001
GRAFANA_EXTERNAL_URL=http://192.168.18.114:3001
# Grafana 管理员认证
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=grafana123
# Grafana 数据库配置
GRAFANA_DATABASE_TYPE=sqlite3
GRAFANA_DATABASE_PATH=/var/lib/grafana/grafana.db
# Grafana 插件配置
GRAFANA_INSTALL_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource
# Grafana 配置路径
GRAFANA_PROVISIONING_PATH=/etc/grafana/provisioning
# ==================== AlertManager 告警配置 ====================
# AlertManager 服务配置
ALERTMANAGER_ENABLED=true
ALERTMANAGER_HOST=alertmanager
ALERTMANAGER_PORT=9093
ALERTMANAGER_EXTERNAL_PORT=9093
ALERTMANAGER_EXTERNAL_URL=http://192.168.18.114:9093
# AlertManager 配置路径
ALERTMANAGER_CONFIG_PATH=/etc/alertmanager
ALERTMANAGER_DATA_PATH=/alertmanager
# AlertManager 告警路由配置
ALERTMANAGER_DEFAULT_GROUP_WAIT=30s
ALERTMANAGER_DEFAULT_GROUP_INTERVAL=5m
ALERTMANAGER_DEFAULT_REPEAT_INTERVAL=4h
# ==================== 告警通知配置 ====================
# 邮件通知配置
ALERT_EMAIL_ENABLED=true
ALERT_EMAIL_FROM=alerts@ai-infra.com
ALERT_EMAIL_TO=admin@ai-infra.com,ops@ai-infra.com
ALERT_EMAIL_SMARTHOST=smtp.aliyun.com:25
ALERT_EMAIL_AUTH_USERNAME=your-email@aliyun.com
ALERT_EMAIL_AUTH_PASSWORD=your-email-password
# Slack 通知配置
ALERT_SLACK_ENABLED=false
ALERT_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
ALERT_SLACK_CHANNEL=#alerts
ALERT_SLACK_USERNAME=AlertManager
# PagerDuty 通知配置
ALERT_PAGERDUTY_ENABLED=false
ALERT_PAGERDUTY_ROUTING_KEY=your-routing-key
# DingTalk 钉钉通知配置
ALERT_DINGTALK_ENABLED=false
ALERT_DINGTALK_WEBHOOK=https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN
# ==================== Node Exporter 配置 ====================
# Node Exporter 导出器配置
NODE_EXPORTER_ENABLED=true
NODE_EXPORTER_PORT=9100
NODE_EXPORTER_VERSION=v1.8.2
# Node Exporter 文本文件收集器配置
NODE_EXPORTER_TEXTFILE_COLLECTOR_PATH=/var/lib/node_exporter/textfile_collector
# ==================== SLURM Exporter 配置 ====================
# SLURM Exporter 导出器配置
SLURM_EXPORTER_ENABLED=true
SLURM_EXPORTER_PORT=9341
SLURM_EXPORTER_VERSION=v0.0.10
# SLURM Exporter 访问配置
SLURM_EXPORTER_HOST=slurm-master
SLURM_EXPORTER_TIMEOUT=10s
# ==================== DCGM Exporter 配置（GPU监控）====================
# DCGM Exporter 导出器配置
DCGM_EXPORTER_ENABLED=false
DCGM_EXPORTER_PORT=9400
DCGM_EXPORTER_VERSION=latest
# DCGM 采集间隔
DCGM_COLLECTION_INTERVAL=30000
# ==================== 自定义指标收集器配置 ====================
# 自定义指标收集
CUSTOM_METRICS_ENABLED=true
CUSTOM_METRICS_COLLECTION_INTERVAL=5m
CUSTOM_METRICS_OUTPUT_PATH=/var/lib/node_exporter/textfile_collector
# ==================== 监控告警规则配置 ====================
# 告警规则配置
ALERT_RULES_ENABLED=true
ALERT_RULES_PATH=/etc/prometheus/rules
# 节点告警配置
ALERT_NODE_CPU_THRESHOLD=80
ALERT_NODE_MEMORY_THRESHOLD=85
ALERT_NODE_DISK_THRESHOLD=85
ALERT_NODE_LOAD_THRESHOLD=4.0
# SLURM 告警配置
ALERT_SLURM_DOWN_DURATION=2m
ALERT_SLURM_NODES_DOWN_DURATION=5m
ALERT_SLURM_JOBS_PENDING_DURATION=30m
# GPU 告警配置
ALERT_GPU_TEMP_THRESHOLD=85
ALERT_GPU_MEMORY_THRESHOLD=90
# 容器告警配置
ALERT_CONTAINER_RESTART_THRESHOLD=5
ALERT_CONTAINER_CPU_THRESHOLD=80
ALERT_CONTAINER_MEMORY_THRESHOLD=85
# ==================== 监控数据导出配置 ====================
# 远程存储配置（可选）
PROMETHEUS_REMOTE_WRITE_ENABLED=false
PROMETHEUS_REMOTE_WRITE_URL=http://remote-prometheus:9009/api/v1/write
# 指标导出配置
METRICS_EXPORT_INTERVAL=1m
METRICS_EXPORT_FORMAT=json
# ==================== 监控界面配置 ====================
# 前端监控集成
MONITORING_DASHBOARD_ENABLED=true
MONITORING_REFRESH_INTERVAL=30s
MONITORING_HISTORY_DAYS=7
# Grafana iframe 嵌入配置
GRAFANA_IFRAME_ENABLED=true
GRAFANA_EMBED_TIMEOUT=8000
# Prometheus iframe 嵌入配置
PROMETHEUS_IFRAME_ENABLED=true
PROMETHEUS_EMBED_TIMEOUT=8000
# AlertManager iframe 嵌入配置
ALERTMANAGER_IFRAME_ENABLED=true
ALERTMANAGER_EMBED_TIMEOUT=8000
# Salt API超时配置 (test.ping操作可能需要较长时间)
SALT_API_TIMEOUT=65s
# ==================== SLURM Master SSH 配置 ====================
# SLURM Master SSH连接配置（用于缩容等操作）
SLURM_MASTER_HOST=slurm-master
SLURM_MASTER_PORT=22
SLURM_MASTER_USER=root
SLURM_MASTER_PASSWORD=slurm123
# ==================== 版本管理配置 ====================
# Docker 基础镜像版本
# Golang 基础镜像
GOLANG_VERSION=1.25
GOLANG_ALPINE_VERSION=1.25-alpine
# Node.js 基础镜像
NODE_VERSION=22
NODE_ALPINE_VERSION=22-alpine
# Python 基础镜像
PYTHON_VERSION=3.14
PYTHON_ALPINE_VERSION=3.14-alpine
# Ubuntu 基础镜像
UBUNTU_VERSION=22.04
# Rocky Linux 基础镜像
ROCKYLINUX_VERSION=9
# Nginx 基础镜像
NGINX_VERSION=stable-alpine-perl
NGINX_ALPINE_VERSION=1.27-alpine
# HAProxy 基础镜像
HAPROXY_VERSION=2.9-alpine
# Jupyter 基础镜像
JUPYTER_BASE_NOTEBOOK_VERSION=latest
# 应用组件版本
# Gitea 版本
GITEA_VERSION=1.25.1
# SaltStack 版本
# SLURM 版本
# AppHub 组件版本
# 依赖工具版本
# Python pip 版本
PIP_VERSION=24.2
# JupyterHub 版本
JUPYTERHUB_VERSION=5.3.*
# Go 模块代理
GO_PROXY=https://goproxy.cn,https://proxy.golang.org,direct
# PyPI 镜像源
PYPI_INDEX_URL=https://mirrors.aliyun.com/pypi/simple/
# npm 镜像源
NPM_REGISTRY=https://registry.npmmirror.com
ALPINE_VERSION=3.22
NPM_VERSION=
OCEANBASE_VERSION=4.3.5-lts
OCEANBASE_MODE=mini
OB_ROOT_PASSWORD=
OB_CLUSTER_NAME=ai-infra-ob
OB_TENANT_NAME=test
OB_TENANT_PASSWORD=
OCEANBASE_INIT_DIR=./data/oceanbase/init.d
OCEANBASE_DATA_DIR=./data/oceanbase/data
OCEANBASE_MEMORY_LIMIT=8G
OCEANBASE_MEMORY_RESERVATION=4G
